# ip地址解析
* https://github.com/lionsoul2014/ip2region 这个项目还是挺厉害的。简单地说，就是掏了 淘宝ip、GeoIP、纯真IP 的库。

# 如何统计Yarn上某个Job当前占用的资源？
* 这里说可以获取 memorySeconds 和 vcoreSeconds
  https://community.cloudera.com/t5/Cloudera-Manager-Installation/CPU-and-Memory-Usage-per-job-perspective/td-p/47786  
  但并不是我希望得到的数据。
* 那应该如何统计？直接到NodeManager上看看行不行？
从 node manager日志来看，有单个进程的数据
```text
2019-06-04 16:16:05,343 INFO org.apache.hadoop.yarn.server.nodemanager.containermanager.monitor.ContainersMonitorImpl: Memory usage of ProcessTree 16513 for container-id container_e76_15523179550xx_1159xx_01_010864: 1.5 GB of 6 GB physical memory used; 6.1 GB of 12.6 GB virtual memory used
2019-06-04 16:16:05,365 INFO org.apache.hadoop.yarn.server.nodemanager.containermanager.monitor.ContainersMonitorImpl: Memory usage of ProcessTree 40886 for container-id container_e76_15523179550xx_1424xx_01_045183: 847.4 MB of 10 GB physical memory used; 8.2 GB of 21 GB virtual memory used
2019-06-04 16:16:05,393 INFO org.apache.hadoop.yarn.server.nodemanager.containermanager.monitor.ContainersMonitorImpl: Memory usage of ProcessTree 45871 for container-id container_e76_15523179550xx_1159xx_01_011255: 1.5 GB of 6 GB physical memory used; 6.1 GB of 12.6 GB virtual memory used
```

NodeManager进程树如下：
```
org.apache.hadoop.yarn.server.nodemanager.NodeManager
  \ - bash /path/to/hadoop-tmp/nm-local-dir/usercache/dict/appcache/application_15523179550xx_1159xx/container_e76_15523179550xx_1159xx_01_010864/default_container_executor.sh
*   \ - /bin/bash -c /path/to/java -server -XX:OnOutOfMemoryError='kill %p' -Xms4096m -Xmx4096m '-XX:MaxDirectMemorySize=2g' -Djava.io.tmpdir=/path/to/hadoop-tmp/nm-local-dir/usercache/dict/appcache/application_15523179550xx_1159xx/container_e76_1552317955022_115979_01_011255/tmp '-Dspark.driver.port=32573' -Dspark.yarn.app.container.log.dir=/disk9/eadop/hadoop-tmp/userlogs/application_1552317955022_115979/container_e76_1552317955022_115979_01_011255 org.apache.spark.executor.CoarseGrainedExecutorBackend --driver-url spark://CoarseGrainedScheduler@10.168.15.2:32573 --executor-id 302 --hostname hd012.corp.yodao.com --cores 4 --app-id application_1552317955022_115979 --user-class-path file:/disk11/eadop/hadoop-tmp/nm-local-dir/usercache/dict/appcache/application_1552317955022_115979/container_e76_1552317955022_115979_01_011255/__app__.jar 1> /path/to/hadoop-tmp/userlogs/application_15523179550xx_1159xx/container_e76_15523179550xx_1159xx_01_011255/stdout 2> /path/to/hadoop-tmp/userlogs/application_15523179550xx_1159xx/container_e76_15523179550xx_1159xx_01_011255/stderr
      \ - xxx
  \ - bash ... default_container_executor.sh
    \ -
    
```
带 * 的就是NodeManager log中对应的PID。
