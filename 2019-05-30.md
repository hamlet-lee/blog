# 磁盘使用增长的问题
1. 首先 使用 du-some.sh；
    ```shell
    #!/bin/sh
    du -b --exclude=.git --max-depth=3 . > du-1.txt
    sleep 1200
    du -b --exclude=.git --max-depth=3 . > du-2.txt
    sleep 1200
    du -b --exclude=.git --max-depth=3 . > du-3.txt
    ```
    
    例如
    ```shell
    # 第一天
    ~/du-some.sh
    
    # 第二天du之前把第一天的结果文件改下名，然后再du
    mv du-1.txt du-1.txt.20190527
    ~/du-some.sh
    ```
1. 然后 使用 du_diff.pl
    ```perl
    #!/usr/bin/perl
    use POSIX;
    if(scalar(@ARGV) != 2 ) {
      die "usage: <du result1> <du result2>";
    }
    my $in1 = $ARGV[0];
    my $in2 = $ARGV[1];

    my %data;
    open my $f1,"<$in1";
    while(<$f1>){
      $_ =~ /(\d+)\t(.*?)\n/;
      #print "[$1][".$2."]\n";
      $data{$2}=$1;
    }
    close($f1);

    my %data2;
    open my $f2, "<$in2";
    while(<$f2>){
      $_ =~ /(\d+)\t(.*?)\n/;
      #print "[$1][".$2."]\n";
      if(defined $data{$2} ) {
        $data2{$2}=$1;
      }
    }
    close($f2);

    my %data_diff;
    foreach $k (keys %data2) {
      my $s1 = $data{$k};
      my $s2 = $data2{$k};
      my $d = $s2 - $s1;
      # 只考虑变化大于1GB的
      if( $d > 1024 * 1024 * 1024 ) {
        $data_diff{$k} = $d;
      }
      #print "$k\t$s1\t$s2\n";
    }

    foreach $k (sort keys %data_diff) {
      print "$k\t".$data_diff{$k}."\t".ceil($data_diff{$k} / 1024 / 1024 / 1024) . "GB\n";
    }
    ```
例如：
```shell
$ ~/du_diff.pl du-1.txt.20190527  du-1.txt
./data	20124294386	19GB
./data/kafka-logs	20124294386	19GB
./data/kafka-logs/xxx	11251302413	11GB
./data/kafka-logs/yyy	1778673447	2GB
./zookeeper-x.x.x	17703515555	17GB
./zookeeper-x.x.x/zk_data	17621496195	17GB
./zookeeper-x.x.x/zk_data/version-2	17621496195	17GB
```
就能发现，增长比较多的是kafka 和 zookeeper 的目录。

